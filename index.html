<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Pr√©-Qualifica√ß√£o Factoring - Aprova√ß√£o em 60 Segundos</title>

  <style>
    :root{
      --bg1:#0b1220;
      --bg2:#0f172a;
      --text:#e5e7eb;
      --muted:#a7b0c0;
      --border: rgba(255,255,255,.10);
      --border2: rgba(255,255,255,.14);
      --brand1:#7c3aed;
      --brand2:#22c55e;
      --shadow: 0 20px 60px rgba(0,0,0,.45);
      --radius: 18px;
    }
    *{ box-sizing:border-box; margin:0; padding:0; }
    html, body { height: 100%; }
    body{
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      color: var(--text);
      background:
        radial-gradient(1200px 600px at 15% 20%, rgba(124,58,237,.35), transparent 60%),
        radial-gradient(900px 500px at 80% 10%, rgba(34,197,94,.22), transparent 55%),
        linear-gradient(180deg, var(--bg1), var(--bg2));
      display:flex;
      align-items:center;
      justify-content:center;
      padding: 24px;
    }

    .wrap{
      width: min(860px, 100%);
      display:grid;
      grid-template-columns: 1.05fr .95fr;
      gap: 18px;
    }

    @media (max-width: 860px){
      .wrap{ grid-template-columns: 1fr; }
      section.panel{ order: 1; }
      aside.panel.side{ order: 2; }
    }
    @media (max-width: 520px){
  body{
    align-items: flex-start !important;
    justify-content: flex-start !important;
    min-height: 100vh !important;
    height: auto !important;
    padding: 14px !important;
  }

  .panel-inner{ padding: 18px !important; }
  .title{ font-size: 22px !important; }
}

    .panel{
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      border: 1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .panel-inner{ padding: 26px; }

    .brandbar{
      padding: 18px 26px;
      background: linear-gradient(90deg, rgba(124,58,237,.25), rgba(34,197,94,.18));
      border-bottom: 1px solid var(--border);
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 12px;
    }
    .pill{
      display:inline-flex; align-items:center; gap: 8px;
      font-size: 12px; color: var(--text);
      padding: 8px 10px;
      border: 1px solid var(--border);
      border-radius: 999px;
      background: rgba(0,0,0,.18);
      white-space: nowrap;
    }

    .title{ font-size: 26px; line-height: 1.15; margin-bottom: 10px; }
    .subtitle{ color: var(--muted); font-size: 14px; line-height: 1.55; margin-bottom: 18px; }

    .progress{
      height: 10px; background: rgba(255,255,255,.08);
      border: 1px solid var(--border);
      border-radius: 999px; overflow:hidden;
      margin: 18px 0 14px;
    }
    .progress > div{
      height:100%; width: 0%;
      background: linear-gradient(90deg, var(--brand1), var(--brand2));
      transition: width .25s ease;
    }

    .stephead{ display:flex; justify-content:space-between; gap: 12px; margin-bottom: 12px; }
    .step{ color: var(--muted); font-size: 12px; }

    .question-title{ font-size: 18px; font-weight: 700; margin-bottom: 6px; }
    .question-help{ color: var(--muted); font-size: 13px; line-height: 1.5; margin-bottom: 14px; }

    .question-container{ display:none; }
    .question-container.active{ display:block; animation: fadeUp .25s ease; }
    @keyframes fadeUp{ from{ opacity:0; transform:translateY(8px);} to{ opacity:1; transform:translateY(0);} }

    .options{ display:grid; gap: 10px; }
    .option{
      border: 1px solid var(--border);
      background: rgba(255,255,255,.04);
      border-radius: 14px;
      padding: 14px 14px;
      display:flex; gap: 12px; align-items:flex-start;
      cursor:pointer;
    }
    .option:hover{ border-color: var(--border2); background: rgba(255,255,255,.06); }
    .option input{ margin-top: 2px; width: 18px; height: 18px; accent-color: var(--brand1); }

    .opt-text strong{ font-size:14px; display:block; }
    .opt-text span{ font-size:13px; color: var(--muted); }

    .btnrow{ display:flex; gap:10px; margin-top:16px; }
    .btn{
      border: 1px solid var(--border);
      background: rgba(255,255,255,.06);
      color: var(--text);
      padding: 12px 14px;
      border-radius: 12px;
      font-weight: 700;
      cursor:pointer;
      flex: 1;
    }
    .btn:disabled{ opacity:.45; cursor:not-allowed; }
    .btn-primary{
      border-color: rgba(124,58,237,.45);
      background: linear-gradient(135deg, rgba(124,58,237,.55), rgba(34,197,94,.25));
    }
    .btn-secondary{ background: rgba(0,0,0,.18); }

    .grid{ display:grid; grid-template-columns: 1fr 1fr; gap: 10px; }
    @media (max-width: 520px){ .grid{ grid-template-columns: 1fr; } }

    .field{ display:flex; flex-direction:column; gap: 6px; margin-top: 10px; }
    .field label{ font-size: 12px; color: var(--muted); }
    .input{
      border: 1px solid var(--border);
      background: rgba(0,0,0,.18);
      color: var(--text);
      padding: 12px 12px;
      border-radius: 12px;
      font-size: 14px;
      outline: none;
    }
    .error{ color:#fecaca; font-size:12px; margin-top:6px; display:none; }
    .error.show{ display:block; }

    .lgpd{
      margin-top: 12px;
      border: 1px solid var(--border);
      background: rgba(255,255,255,.03);
      border-radius: 14px;
      padding: 12px;
      display:flex; gap: 10px; align-items:flex-start;
    }
    .lgpd input{ margin-top: 2px; width: 18px; height: 18px; accent-color: var(--brand1); }
    .lgpd a{ color: #c4b5fd; text-decoration: underline; }

    .result{ display:none; }
    .result.active{ display:block; }

    .cta{
      margin-top: 12px;
      border-radius: 14px;
      padding: 14px;
      border: 1px solid rgba(34,197,94,.22);
      background: linear-gradient(135deg, rgba(34,197,94,.14), rgba(124,58,237,.18));
      display:flex; justify-content:space-between; gap: 12px; flex-wrap: wrap;
    }
    .cta a{
      display:inline-flex; align-items:center; justify-content:center;
      text-decoration:none; color: #04110a; font-weight: 900;
      padding: 12px 14px; border-radius: 12px;
      background: linear-gradient(135deg, #22c55e, #a3e635);
      white-space: nowrap;
    }

    aside.panel.side h3{ font-size: 15px; margin-bottom: 10px; }
    .cards{ display:grid; gap:10px; margin-top:10px; }
    .mini{
      border: 1px solid var(--border);
      background: rgba(255,255,255,.03);
      border-radius: 14px;
      padding: 12px;
      display:flex; gap: 10px; align-items:flex-start;
    }
    .mini .ico{
      width: 34px; height: 34px; display:grid; place-items:center;
      border-radius: 10px;
      background: rgba(124,58,237,.18);
      border: 1px solid rgba(124,58,237,.25);
      flex: 0 0 auto;
    }
    .mini strong{ display:block; font-size: 13px; margin-bottom: 2px; }
    .mini span{ color: var(--muted); font-size: 12.5px; line-height:1.45; }
  </style>
</head>

<body>
  <div class="wrap">
    <section class="panel">
      <div class="brandbar">
        <div class="pill">‚è±Ô∏è 60 segundos</div>
        <div class="pill">üîí Seus dados s√£o protegidos</div>
      </div>

      <div class="panel-inner">
        <h1 class="title">Descubra em 60 segundos se sua empresa est√° pr√©-aprovada</h1>
        <p class="subtitle">Responda 4 perguntas r√°pidas e receba um direcionamento imediato sobre antecipa√ß√£o de receb√≠veis.</p>

        <div class="progress"><div id="progressBar"></div></div>

        <div class="stephead">
          <div class="step" id="stepText">Etapa 1 de 5</div>
          <div class="step" id="stepHint">Selecione uma op√ß√£o</div>
        </div>

        <!-- Q1 -->
        <div class="question-container active" id="question1" data-step="1">
          <div class="question-title">1) H√° quanto tempo sua empresa est√° em opera√ß√£o?</div>
          <div class="question-help">Precisamos de empresas com hist√≥rico m√≠nimo de atividade.</div>
          <div class="options">
            <div class="option" tabindex="0" data-radio="q1a"><input type="radio" name="q1" id="q1a" value="menos6"><div class="opt-text"><strong>Menos de 6 meses</strong><span>Pode exigir an√°lise adicional.</span></div></div>
            <div class="option" tabindex="0" data-radio="q1b"><input type="radio" name="q1" id="q1b" value="6a12"><div class="opt-text"><strong>Entre 6 meses e 1 ano</strong><span>Depende dos demais fatores.</span></div></div>
            <div class="option" tabindex="0" data-radio="q1c"><input type="radio" name="q1" id="q1c" value="mais1"><div class="opt-text"><strong>Mais de 1 ano ‚úÖ</strong><span>Excelente hist√≥rico.</span></div></div>
          </div>
          <div class="btnrow"><button class="btn btn-primary" id="btnNext1" disabled>Pr√≥xima ‚Üí</button></div>
        </div>

        <!-- Q2 -->
        <div class="question-container" id="question2" data-step="2">
          <div class="question-title">2) Qual √© o faturamento mensal m√©dio da sua empresa?</div>
          <div class="question-help">Precisamos de um volume m√≠nimo para viabilizar a opera√ß√£o.</div>
          <div class="options">
            <div class="option" tabindex="0" data-radio="q2a"><input type="radio" name="q2" id="q2a" value="menos30"><div class="opt-text"><strong>Menos de R$ 30.000</strong><span>Pode limitar o teto.</span></div></div>
            <div class="option" tabindex="0" data-radio="q2b"><input type="radio" name="q2" id="q2b" value="30a50"><div class="opt-text"><strong>Entre R$ 30.000 e R$ 50.000</strong><span>Faixa comum.</span></div></div>
            <div class="option" tabindex="0" data-radio="q2c"><input type="radio" name="q2" id="q2c" value="mais50"><div class="opt-text"><strong>Acima de R$ 50.000 ‚úÖ</strong><span>Melhor cen√°rio.</span></div></div>
          </div>
          <div class="btnrow">
            <button class="btn btn-secondary" id="btnBack2">‚Üê Voltar</button>
            <button class="btn btn-primary" id="btnNext2" disabled>Pr√≥xima ‚Üí</button>
          </div>
        </div>

        <!-- Q3 -->
        <div class="question-container" id="question3" data-step="3">
          <div class="question-title">3) Sua empresa possui certid√µes negativas v√°lidas?</div>
          <div class="question-help">Federal, Estadual, Municipal, FGTS e Trabalhista.</div>
          <div class="options">
            <div class="option" tabindex="0" data-radio="q3a"><input type="radio" name="q3" id="q3a" value="sim"><div class="opt-text"><strong>Sim, todas em dia ‚úÖ</strong><span>√ìtimo: reduz atritos.</span></div></div>
            <div class="option" tabindex="0" data-radio="q3b"><input type="radio" name="q3" id="q3b" value="naosei"><div class="opt-text"><strong>N√£o sei / Preciso verificar</strong><span>Podemos orientar.</span></div></div>
            <div class="option" tabindex="0" data-radio="q3c"><input type="radio" name="q3" id="q3c" value="nao"><div class="opt-text"><strong>N√£o, tenho pend√™ncias</strong><span>Geralmente precisa regularizar.</span></div></div>
          </div>
          <div class="btnrow">
            <button class="btn btn-secondary" id="btnBack3">‚Üê Voltar</button>
            <button class="btn btn-primary" id="btnNext3" disabled>Pr√≥xima ‚Üí</button>
          </div>
        </div>

        <!-- Q4 -->
        <div class="question-container" id="question4" data-step="4">
          <div class="question-title">4) Seus clientes (pagadores) s√£o empresas estabelecidas?</div>
          <div class="question-help">Avaliamos a solidez de quem vai pagar as duplicatas.</div>
          <div class="options">
            <div class="option" tabindex="0" data-radio="q4a"><input type="radio" name="q4" id="q4a" value="sim"><div class="opt-text"><strong>Sim, empresas s√≥lidas ‚úÖ</strong><span>Melhor cen√°rio.</span></div></div>
            <div class="option" tabindex="0" data-radio="q4b"><input type="radio" name="q4" id="q4b" value="misto"><div class="opt-text"><strong>Misto</strong><span>Depende do mix.</span></div></div>
            <div class="option" tabindex="0" data-radio="q4c"><input type="radio" name="q4" id="q4c" value="nao"><div class="opt-text"><strong>Maioria pequena/informal</strong><span>Pode dificultar limites.</span></div></div>
          </div>
          <div class="btnrow">
            <button class="btn btn-secondary" id="btnBack4">‚Üê Voltar</button>
            <button class="btn btn-primary" id="btnToForm" disabled>Ver resultado ‚Üí</button>
          </div>
        </div>

        <!-- FORM -->
        <div class="question-container" id="contactForm" data-step="5">
          <div class="question-title">√öltima etapa: seus dados</div>
          <div class="question-help">Ao enviar, voc√™ ver√° o resultado e poder√° chamar no WhatsApp.</div>

          <div class="grid">
            <div class="field">
              <label>Nome completo *</label>
              <input class="input" id="name" type="text">
              <div class="error" id="errName">Informe seu nome.</div>
            </div>
            <div class="field">
              <label>Empresa *</label>
              <input class="input" id="company" type="text">
              <div class="error" id="errCompany">Informe a empresa.</div>
            </div>
          </div>

          <div class="grid">
            <div class="field">
              <label>CNPJ *</label>
              <input class="input" id="cnpj" type="text" inputmode="numeric" placeholder="00.000.000/0000-00">
              <div class="error" id="errCnpj">Informe um CNPJ v√°lido.</div>
            </div>
            <div class="field">
              <label>E-mail *</label>
              <input class="input" id="email" type="email">
              <div class="error" id="errEmail">Informe um e-mail v√°lido.</div>
            </div>
          </div>

          <div class="grid">
            <div class="field">
              <label>WhatsApp (DDD) *</label>
              <input class="input" id="phone" type="tel" inputmode="numeric">
              <div class="error" id="errPhone">Informe um WhatsApp v√°lido.</div>
            </div>
            <div class="field">
              <label>&nbsp;</label>
              <div class="subtitle" style="margin:0">* Campos obrigat√≥rios</div>
            </div>
          </div>

          <div class="lgpd">
            <input type="checkbox" id="lgpd" />
            <p>Eu concordo com a <a id="policyLink" href="#" target="_blank" rel="noopener">Pol√≠tica de Privacidade</a>. *</p>
          </div>
          <div class="error" id="errLgpd">Voc√™ precisa aceitar para continuar.</div>

          <div class="btnrow">
            <button class="btn btn-secondary" id="btnBackForm">‚Üê Voltar</button>
            <button class="btn btn-primary" id="btnShowResult">üéØ Ver meu resultado</button>
          </div>

          <div class="subtitle" id="formNote" style="margin-top:10px;"></div>
        </div>

        <div class="result" id="resultContainer"></div>
      </div>
    </section>

    <aside class="panel side">
      <div class="panel-inner">
        <h3>O que voc√™ vai receber</h3>
        <p class="subtitle">Direcionamento imediato e, se fizer sentido, seguimos com an√°lise dos receb√≠veis e pagadores.</p>
        <div class="cards">
          <div class="mini"><div class="ico">üìå</div><div><strong>Resultado em 1 minuto</strong><span>Pr√©-aprovado / em an√°lise / n√£o eleg√≠vel.</span></div></div>
          <div class="mini"><div class="ico">üìÑ</div><div><strong>Documentos comuns</strong><span>Contrato social, certid√µes, notas/duplicatas e pagadores.</span></div></div>
          <div class="mini"><div class="ico">‚è±Ô∏è</div><div><strong>Tempo m√©dio</strong><span>Resposta humana geralmente em at√© 24h.</span></div></div>
        </div>
      </div>
    </aside>
  </div>

  <script>
    const WHATSAPP = '5531988008600';
    const PRIVACY_POLICY_URL = 'https://SEU-DOMINIO.com/politica-de-privacidade';
    const GOOGLE_SHEETS_WEBAPP_URL = 'https://script.google.com/macros/s/AKfycbyDdDzOFxZP8_Q_a6L4T7LsnogW68t5reWl31PhJqQ6SjOj8AFBZR1Ax_CEs5QoFxk/exec';

    let currentQuestion = 1;
    const answers = {};
    const totalSteps = 5;

    function setActive(id){
      document.querySelectorAll('.question-container').forEach(el=>el.classList.remove('active'));
      const el = document.getElementById(id);
      el.classList.add('active');
      currentQuestion = Number(el.dataset.step||1);
      document.getElementById('progressBar').style.width = Math.round((currentQuestion/totalSteps)*100)+'%';
      document.getElementById('stepText').textContent = `Etapa ${currentQuestion} de ${totalSteps}`;
      document.getElementById('stepHint').textContent = currentQuestion<=4 ? 'Selecione uma op√ß√£o' : 'Preencha seus dados';
    }

    function wireOptionCards(){
      document.querySelectorAll('.option').forEach(card=>{
        const id = card.getAttribute('data-radio');
        const input = document.getElementById(id);
        card.addEventListener('click', ()=>{ input.checked=true; input.dispatchEvent(new Event('change',{bubbles:true})); });
      });
    }

    function setNextEnabled(n, enabled){
      const btn = document.getElementById(`btnNext${n}`) || (n===4?document.getElementById('btnToForm'):null);
      if(btn) btn.disabled = !enabled;
    }

    function watchRadios(){
      [1,2,3,4].forEach(n=>{
        document.querySelectorAll(`input[name="q${n}"]`).forEach(r=>{
          r.addEventListener('change', ()=>{
            answers[`q${n}`] = document.querySelector(`input[name="q${n}"]:checked`)?.value;
            setNextEnabled(n,true);
          });
        });
      });
    }

    function scoreIt(){
      let s=0;
      if(answers.q1==='mais1') s+=3; else if(answers.q1==='6a12') s+=2;
      if(answers.q2==='mais50') s+=3; else if(answers.q2==='30a50') s+=2;
      if(answers.q3==='sim') s+=3; else if(answers.q3==='naosei') s+=1;
      if(answers.q4==='sim') s+=3; else if(answers.q4==='misto') s+=2;
      return s;
    }
    function statusFromScore(s){ return s>=10?'PRE_APROVADO':(s>=6?'EM_ANALISE':'NAO_ELEGIVEL'); }

    function onlyDigits(v){ return String(v||'').replace(/\D/g,''); }
    function validateEmail(v){ return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(String(v||'').trim()); }

    function validateCnpj(raw){
      const cnpj = onlyDigits(raw);
      if(cnpj.length!==14) return false;
      if(/^(\d)\1+$/.test(cnpj)) return false;
      const calc=(base)=>{
        let sum=0,pos=base.length-7;
        for(let i=base.length;i>=1;i--){
          sum += Number(base.charAt(base.length-i))*pos--;
          if(pos<2) pos=9;
        }
        const mod=sum%11;
        return (mod<2)?0:(11-mod);
      };
      const d1=calc(cnpj.substring(0,12));
      const d2=calc(cnpj.substring(0,13));
      return cnpj.endsWith(String(d1)+String(d2));
    }
    function maskCnpj(v){
      v=onlyDigits(v).slice(0,14);
      v=v.replace(/^(\d{2})(\d)/,'$1.$2');
      v=v.replace(/^(\d{2})\.(\d{3})(\d)/,'$1.$2.$3');
      v=v.replace(/\.(\d{3})(\d)/,'.$1/$2');
      v=v.replace(/(\d{4})(\d)/,'$1-$2');
      return v;
    }
    function phoneMask(v){
      v=onlyDigits(v).slice(0,11);
      if(v.length<=10) return v.replace(/^(\d{2})(\d)/,'($1) $2').replace(/(\d{4})(\d{4})$/,'$1-$2');
      return v.replace(/^(\d{2})(\d)/,'($1) $2').replace(/(\d{5})(\d{4})$/,'$1-$2');
    }

    function validateForm(){
      const name=document.getElementById('name').value.trim();
      const company=document.getElementById('company').value.trim();
      const cnpjRaw=document.getElementById('cnpj').value.trim();
      const email=document.getElementById('email').value.trim();
      const phone=onlyDigits(document.getElementById('phone').value);
      const lgpd=document.getElementById('lgpd').checked;

      const okName=name.length>=3;
      const okCompany=company.length>=2;
      const okCnpj=validateCnpj(cnpjRaw);
      const okEmail=validateEmail(email);
      const okPhone=phone.length>=10 && phone.length<=11;
      const okLgpd=lgpd;

      document.getElementById('errName').classList.toggle('show',!okName);
      document.getElementById('errCompany').classList.toggle('show',!okCompany);
      document.getElementById('errCnpj').classList.toggle('show',!okCnpj);
      document.getElementById('errEmail').classList.toggle('show',!okEmail);
      document.getElementById('errPhone').classList.toggle('show',!okPhone);
      document.getElementById('errLgpd').classList.toggle('show',!okLgpd);

      return { ok: okName&&okCompany&&okCnpj&&okEmail&&okPhone&&okLgpd, name, company, cnpj: onlyDigits(cnpjRaw), email, phone };
    }

    function captureUtm(){
      const url = new URL(window.location.href);
      const utm = {
        utm_source: url.searchParams.get('utm_source')||'',
        utm_campaign: url.searchParams.get('utm_campaign')||'',
        utm_medium: url.searchParams.get('utm_medium')||'',
        utm_content: url.searchParams.get('utm_content')||'',
        utm_term: url.searchParams.get('utm_term')||'',
        gclid: url.searchParams.get('gclid')||'',
        fbclid: url.searchParams.get('fbclid')||''
      };
      localStorage.setItem('lp_utm', JSON.stringify(utm));
      return utm;
    }
    function readUtm(){
      try{ const s=localStorage.getItem('lp_utm'); if(s) return JSON.parse(s); }catch(e){}
      return captureUtm();
    }

    // ‚úÖ ENVIO MAIS CONFI√ÅVEL: form-urlencoded (payload=JSON)
    function sendToGoogleSheets(payload){
      try{
        const body = new URLSearchParams();
        body.set('payload', JSON.stringify(payload));

        fetch(GOOGLE_SHEETS_WEBAPP_URL, {
          method: 'POST',
          mode: 'no-cors',
          headers: { 'Content-Type': 'application/x-www-form-urlencoded;charset=UTF-8' },
          body: body.toString(),
          keepalive: true
        });
        return true;
      }catch(e){
        return false;
      }
    }

    function renderResult(score, lead){
      const result = document.getElementById('resultContainer');
      result.classList.add('active');

      const status = statusFromScore(score);
      const tag = status==='PRE_APROVADO'?'PR√â-APROVADO':(status==='EM_ANALISE'?'EM AN√ÅLISE':'N√ÉO ELEG√çVEL');
      const title = status==='PRE_APROVADO' ? 'Parab√©ns!' : (status==='EM_ANALISE'?'Precisamos de mais informa√ß√µes':'Ainda n√£o √© o momento ideal');

      const waMsg =
        `Ol√°! Quero antecipar meus receb√≠veis.\n\n`+
        `Nome: ${lead.name}\nEmpresa: ${lead.company}\nCNPJ: ${lead.cnpj}\nE-mail: ${lead.email}`;

      const waLink = `https://wa.me/${WHATSAPP}?text=${encodeURIComponent(waMsg)}`;

      result.innerHTML = `
        <div class="question-title">${title}</div>
        <div class="subtitle"><strong>${tag}</strong></div>
        <div class="cta">
          <div>
            <strong>Falar no WhatsApp</strong><br/>
            <span class="subtitle" style="margin:0;">Envia nome, empresa, CNPJ e e-mail.</span>
          </div>
          <a href="${waLink}" target="_blank" rel="noopener">üì± WhatsApp</a>
        </div>
      `;
    }

    document.addEventListener('DOMContentLoaded', ()=>{
      document.getElementById('policyLink').href = PRIVACY_POLICY_URL;
      captureUtm();
      wireOptionCards();
      watchRadios();
      setActive('question1');

      document.getElementById('btnNext1').onclick=()=>setActive('question2');
      document.getElementById('btnBack2').onclick=()=>setActive('question1');
      document.getElementById('btnNext2').onclick=()=>setActive('question3');
      document.getElementById('btnBack3').onclick=()=>setActive('question2');
      document.getElementById('btnNext3').onclick=()=>setActive('question4');
      document.getElementById('btnBack4').onclick=()=>setActive('question3');

      document.getElementById('btnToForm').onclick=()=>setActive('contactForm');
      document.getElementById('btnBackForm').onclick=()=>setActive('question4');

      document.getElementById('cnpj').addEventListener('input', e=>e.target.value=maskCnpj(e.target.value));
      document.getElementById('phone').addEventListener('input', e=>e.target.value=phoneMask(e.target.value));

      document.getElementById('btnShowResult').addEventListener('click', ()=>{
        const lead = validateForm();
        if(!lead.ok) return;

        const score = scoreIt();
        const utm = readUtm();
        const payload = {
          timestamp: new Date().toISOString(),
          page_url: window.location.href,
          referrer: document.referrer || '',
          score,
          status: statusFromScore(score),
          name: lead.name,
          company: lead.company,
          cnpj: lead.cnpj,
          email: lead.email,
          phone: lead.phone,
          lgpd_consent: true,
          privacy_policy_url: PRIVACY_POLICY_URL,
          answers: { ...answers },
          utm
        };

        // Op√ß√£o B: grava agora
        sendToGoogleSheets(payload);

        // mostra resultado
        document.getElementById('contactForm').classList.remove('active');
        renderResult(score, lead);
      });
    });
  </script>
</body>
</html>
